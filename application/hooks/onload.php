<?php class onload{private $ci; public function __construct() {$this->ci = & get_instance(); } public function check_login(){$controller = $this->ci->router->class; $method = $this->ci->router->method; if($this->ci->session->userdata("user_id") == null){if($controller=="Main" || $controller=="main" ||  $controller=="load_page" || $controller=="Load_page"){redirect(base_url("index.php/login"),"refresh"); exit(); } } else{if(($controller=="User" || $controller=="user") && $method=='login' ) {redirect(base_url(),"refresh"); exit(); } $data =  $this->ci->session->userdata("user_session"); $check = $this->ci->In_outv2->get_data_login("user",$data); if($check['session_log'] == null){$this->ci->session->sess_destroy(); redirect(base_url(),"refresh"); exit(); } if($controller == 'dashboard' and $this->ci->session->userdata("userlog_type") != 'admin'){redirect(base_url(),"refresh"); exit(); } } } } ?>